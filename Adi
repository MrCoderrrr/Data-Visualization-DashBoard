import tkinter as tk
from tkinter import ttk

# --- ðŸŽ¨ Color & Font Definitions ðŸŽ¨ ---
COLOR_BG = '#1e1e2e'
COLOR_CONTENT_BG = '#181825'
COLOR_CARD = '#313244'
COLOR_TEXT = '#cdd6f4'
COLOR_TEXT_SUBTLE = '#a6adc8'
COLOR_PRIMARY = '#89b4fa'
COLOR_GREEN = '#a6e3a1'
COLOR_RED = '#f38ba8'
COLOR_YELLOW = '#f9e2af'
COLOR_BORDER = '#45475a'

FONT_FAMILY = 'Arial'
FONT_NORMAL = (FONT_FAMILY, 11)
FONT_BOLD = (FONT_FAMILY, 11, 'bold')
FONT_TITLE = (FONT_FAMILY, 24, 'bold')
FONT_H1 = (FONT_FAMILY, 18, 'bold')
FONT_H2 = (FONT_FAMILY, 14, 'bold')
FONT_KPI = (FONT_FAMILY, 28, 'bold')


class AppStyler:
    """Handles all TTK styling for the application."""
    
    def setup_styles(self):
        """Centralized TTK styling for a modern, consistent look."""
        self.style = ttk.Style()
        self.style.theme_use('clam')

        # --- General Widget Styles ---
        self.style.configure('.', 
                             background=COLOR_BG, 
                             foreground=COLOR_TEXT, 
                             font=FONT_NORMAL,
                             bordercolor=COLOR_BORDER)
        
        self.style.configure('TFrame', background=COLOR_BG)
        self.style.configure('TLabel', background=COLOR_BG, foreground=COLOR_TEXT)

        # --- Simple Card Style ---
        self.style.configure('Card.TFrame', 
                             background=COLOR_CARD, 
                             relief='raised', 
                             borderwidth=1, 
                             bordercolor=COLOR_BORDER)
        
        self.style.configure('Card.TLabel', 
                             background=COLOR_CARD, 
                             foreground=COLOR_TEXT, 
                             font=FONT_H2)
        
        self.style.configure('CardSubtle.TLabel', 
                             background=COLOR_CARD, 
                             foreground=COLOR_TEXT_SUBTLE, 
                             font=FONT_H2)
        
        self.style.configure('TButton', 
                             font=FONT_BOLD,
                             background=COLOR_CARD, 
                             foreground=COLOR_TEXT,
                             relief='flat',
                             padding=(10, 8))
        self.style.map('TButton',
                       background=[('active', COLOR_BORDER), ('disabled', COLOR_CARD)],
                       foreground=[('disabled', COLOR_TEXT_SUBTLE)])

        # --- Custom Styles ---
        self.style.configure('Header.TFrame', background=COLOR_PRIMARY)
        self.style.configure('Header.TLabel', 
                             background=COLOR_PRIMARY, 
                             foreground=COLOR_BG, 
                             font=FONT_TITLE)
        
        self.style.configure('Sidebar.TFrame', background=COLOR_CARD)
        
        self.style.configure('Sidebar.TButton', 
                             background=COLOR_CARD, 
                             foreground=COLOR_TEXT_SUBTLE,
                             anchor='w',
                             font=FONT_NORMAL,
                             padding=(15, 10))
        self.style.map('Sidebar.TButton',
                       background=[('active', COLOR_BORDER), ('selected', COLOR_BORDER)],
                       foreground=[('active', COLOR_TEXT), ('selected', COLOR_TEXT)])

        self.style.configure('Accent.TButton', 
                             background=COLOR_PRIMARY, 
                             foreground=COLOR_BG, 
                             font=FONT_BOLD)
        self.style.map('Accent.TButton',
                       background=[('active', '#a0c8ff')])
        
        self.style.configure('Content.TFrame', background=COLOR_CONTENT_BG)
        
        # --- Treeview (Table) Style ---
        self.style.configure('Treeview',
                             background=COLOR_CARD,
                             foreground=COLOR_TEXT,
                             fieldbackground=COLOR_CARD,
                             font=FONT_NORMAL,
                             rowheight=28)
        self.style.configure('Treeview.Heading',
                             background=COLOR_BORDER,
                             foreground=COLOR_TEXT,
                             font=FONT_BOLD,
                             padding=(10, 8))
        self.style.map('Treeview',
                       background=[('selected', COLOR_PRIMARY)],
                       foreground=[('selected', COLOR_BG)])

        # --- Entry Style (for DateEntry and Search) ---
        self.style.configure('TEntry',
                             fieldbackground=COLOR_CARD,
                             foreground=COLOR_TEXT,
                             insertcolor=COLOR_TEXT) # Cursor color
        self.style.map('TEntry',
                       fieldbackground=[('disabled', COLOR_BG), ('readonly', COLOR_CARD)],
                       foreground=[('disabled', COLOR_TEXT_SUBTLE), ('readonly', COLOR_TEXT)])
        
        # --- Combobox Style ---
        self.style.map('TCombobox',
                       fieldbackground=[('readonly', COLOR_CARD)],
                       selectbackground=[('readonly', COLOR_CARD)],
                       selectforeground=[('readonly', COLOR_TEXT)],
                       background=[('readonly', COLOR_CARD)])
        
        # --- Progressbar Style ---
        self.style.configure('Green.Horizontal.TProgressbar', 
                             troughcolor=COLOR_BG, 
                             background=COLOR_GREEN)
        self.style.configure('Red.Horizontal.TProgressbar', 
                             troughcolor=COLOR_BG, 
                             background=COLOR_RED)
        
        # Scrollbar
        self.style.configure('Vertical.TScrollbar', 
                             background=COLOR_CARD, 
                             troughcolor=COLOR_BG, 
                             arrowcolor=COLOR_TEXT)
        self.style.map('Vertical.TScrollbar',
                       background=[('active', COLOR_BORDER)])
